<div class="row" style="margin-bottom: 5px;">
    <div class="col-xs-12 col-sm-2"></div>
    <daterange class="col-xs-12 col-sm-8" startdate="filterStartDate" enddate="filterEndDate" null-allowed="true"></daterange>
    <div id="controls" class="col-xs-12 col-sm-2 text-right">
        <dime-button ng-if="selectedTimeslices.length > 0" glyphicon="arrow-right">Verschieben</dime-button>
    </div>
</div>
<table class="table table-bordered table-hover form">
    <thead>
        <tr>
            <th>Auswahl</th>
            <th ng-if="projectBased">Benutzer</th>
            <th class="col-sm-6">Aktivität</th>
            <th ng-if="blendOutStartAndEnd">Datum</th>
            <th ng-if="blendOutStartAndEnd == false">Start</th>
            <th ng-if="blendOutStartAndEnd == false">Ende</th>
            <th>Dauer/Anzahl</th>
            <th width="60">Aktion</th>
        </tr>
    </thead>
    <tbody ng-if="entities != null">
        <tr ng-repeat="entity in entities | timeslicedatefilter: filterStartDate:filterEndDate | orderBy:'startedAt'" ng-click="selectEntity(entity.id)" ng-class="isSelected(entity)? 'info': ''">
            <td><input type="checkbox" ng-checked="selectedTimeslices.contains(entity.id)" ng-click="toggleTimeslice(entity)"/></td>
            <td ng-if="projectBased"><user-select user="entity.employee" parent-employees="employees" callback="entity.addFieldtoUpdate(name)" field="'employee'"></user-select></td>
            <td><activity-select is-readonly="true" activity="entity.activity" parent-activities="activities" project="entity.project.id" callback="entity.addFieldtoUpdate(name)" field="'activity'"></activity-select></td>
            <td ng-if="blendOutStartAndEnd"><dateinput is-readonly="true" style="width: 100%;" format="'dd-MM-y'" date="entity.startedAt"></dateinput></td>
            <td ng-if="blendOutStartAndEnd == false"><dateinput style="width: 100%;" format="'dd-MM-y HH:mm'" date="entity.startedAt" field="'startedAt'" callback="entity.addFieldtoUpdate(name)"></dateinput></td>
            <td ng-if="blendOutStartAndEnd == false"><dateinput style="width: 100%;" format="'dd-MM-y HH:mm'" date="entity.stoppedAt" field="'stoppedAt'" callback="entity.addFieldtoUpdate(name)"></dateinput></td>
            <td><input style="width: 100%;" class="form-control" ng-model="entity.value" ng-change="addSaveField('value', entity)"/></td>
            <td><button type="button" class="btn btn-default" ng-click="deleteEntity(entity.id)"><i class="fa fa-fw fa-trash-o" style="color:red"></i></button></td>
        </tr>
    </tbody>
</table>
<div class="DimeControlButtons container-inline">
    <div class="row form-inline">
        <div class="col-md-2">
            <label>Datum</label>
            <dateinput date="newEntryDate" has-buttons="true"></dateinput>
            <div>
                <span>automatisch anpassen</span>
                <input class="checkbox" type="checkbox" ng-model="updateNewEntryDate" />
                <help-tooltip text="Stellt das Datum nach dem Erfassen auf das Datum des neusten Eintrags im ausgewaehlten Zeitfenster"></help-tooltip>
            </div>
        </div>
        <div class="col-md-1">
        </div>
        <div ng-if="projectBased == true" class="col-md-2">
            <label>Benutzer</label>
            <user-select clearOnClose="false" parent-employees="employees" user="employee" useContext="false"></user-select>
        </div>
        <div ng-if="projectBased == false" class="col-md-2">
            <label>Benutzer</label>
            <user-select clearOnClose="false" user="employee" useContext="true"></user-select>
        </div>
        <div ng-if="allowProjectSelect" class="col-md-4">
            <label>Projekt</label>
            <project-select hideArchived="true" project="selectedProject"></project-select>
        </div>
        <div class="col-md-2">
            <label>Aktivität</label>
            <activity-select activity="selectedActivity" parent-activities="activities" project="selectedProject.id" field="'activity'" shortname="true"></activity-select>
        </div>
        <div class="col-md-1">
            <label>Wert</label>
            <setting-edit namespace="'/usr/defaults/timeslice'" name="'value'" defaultvalue="'8.4h'"></setting-edit>
        </div>
        <div class="col-md-12" style="margin-top: 5px;">
            <button type="button" class="btn btn-primary" ng-click="createEntity()">Eintrag hinzufügen</button>
            <button type="button" class="btn btn-default" ng-click="duplicateEntity()">Duplizieren</button>
            <button type="button" class="btn btn-default" ng-click="reload(evict: true)"><span class="glyphicon glyphicon-refresh"></span></button>
        </div>
    </div>
</div>
